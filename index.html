<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Arduino Thermo-server by dullahan-soft</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Arduino Thermo-server</h1>
        <p class="header">Automate a masonry heater with an Arduino.</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/dullahan-soft/thermo-server/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/dullahan-soft/thermo-server/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/dullahan-soft/thermo-server">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/dullahan-soft">dullahan-soft</a></p>


      </header>
      <section>
        <h3>Summary</h3>

<p><img src="https://raw.github.com/dullahan-soft/thermo-server/master/images/heater-pre.jpg" width="480" height="480"></p>

<p>A friend of mine recently installed a <a href="http://en.wikipedia.org/wiki/Masonry_heater">masonry heater</a> in his home along with an attached oven and hot water tank.  He asked me if I could help him automate a water pump that passes hot water from the masonry heater to his hot water heater using temperature readings from the masonry heater as well as logging these temperature readings for later analysis.  </p>

<p>The rest of this page contains details on how we automated his system including Arduino code, a data visualization web app, and a parts list.</p>

<h3>System Description</h3>

<p><a href="https://raw.github.com/dullahan-soft/thermo-server/master/images/Thermo%20webserver%20schematic.png">
<img src="https://raw.github.com/dullahan-soft/thermo-server/master/images/Thermo%20webserver%20schematic.png"></a></p>

<p>Following are descriptions for each of the major modules:</p>

<h4>LCD</h4>

<ul>
<li>We attached a monochrome 16x2 LCD for easy local readings.<br>
</li>
<li>You can cycle through the temperature readings using the left and right direction buttons.<br>
</li>
<li>The LCD's backlight powers down after a minute of unuse.</li>
<li>Using Adafruit's LCD backpack and corresponding library, assembling and integrating an LCD was painless.</li>
</ul><h4>Arduino Mega + Ethernet Shield</h4>

<ul>
<li>We choose the Mega to ensure we had enough pins for future expansions.</li>
<li>The Arduino is loaded with a web-server that serves system uptime, pump state, and temperature readings both in HTML and JSON formats.</li>
<li>The web-server uses DHCP.</li>
</ul><h4>PowerSwitch Tail 2</h4>

<ul>
<li>To control the water pump we decided to try out the self contained PowerSwitch.</li>
<li>Interfacing the PowerSwitch with the Arduino only requires two pins, GRND and a digital pin to control the relay.</li>
<li>The pump is hard-coded to turn on when any of the thermocouple sensors detect a temperature in excess of 180 degress Fahrenheit.</li>
<li>In order not to thrash the pump we only check once a minute to see if the pump's state should change (although flucuations in and around 180 degrees are probably
not that great).</li>
</ul><h4>Sensor Array</h4>

<ul>
<li>We went with four thermocouples to measure the temperatures in the oven, masonry heater firebox, water tank, and chimney.</li>
<li>I also added an analog temperature sensor to track the ambient temperature and make sure the Arduino and sensing array don't get too hot!</li>
<li>Adafruit's MAX31855 boards and corresponding library made interfacing with the thermocouples easy, which is a good thing since dealing with the sensitive thermocouples was a pain in the butt.</li>
</ul><h4>Data Logging + Visualization</h4>

<ul>
<li>Originally my friend simply wanted the temperature readings served as HTML which he would scrape with a logging tool like Mango.</li>
<li>I added JSON support and whipped up a clientside data visualization app as well called "dash" short for "dashboard" not "dachshund".</li>
</ul><h3>Parts List</h3>

<p>Here is a list of all the hardware used above as well as links to providers we used and recommend:</p>

<ol>
<li>4 x <a href="https://www.adafruit.com/products/270">K-Type Thermocouples</a>
</li>
<li>4 x <a href="http://www.adafruit.com/products/269">MAX31855 Boards</a> (now includes 0.1 uF capacitors)</li>
<li><a href="https://www.adafruit.com/products/268">PowerSwitch Tail II</a></li>
<li><a href="http://www.adafruit.com/products/191">Arduino Mega</a></li>
<li><a href="https://www.adafruit.com/products/201">Arduino Ethernet Shield</a></li>
<li><a href="http://www.adafruit.com/products/714">Adafruit LCD Shield Kit</a></li>
<li><a href="http://www.adafruit.com/products/165">TMP36 Analog Temperature Sensor</a></li>
<li>
<a href="http://www.adafruit.com/products/435">Passive PoE Injector Cable Set</a> (if you are going to go that route)</li>
</ol><h3>Software and Dash Demo</h3>

<p><img src="https://raw.github.com/dullahan-soft/thermo-server/master/images/dash-pic.png"></p>

<p>The code for the Arduino web-server can be found on <a href="https://github.com/dullahan-soft/thermo-server">github</a>.  The dash app can be found in the same repo.  An example dash instance (running off of simulated data) is also available if you would like to see it in action at <a href="http://demo-dash.herokuapp.com/">demo-dash.herokuapp.com</a></p>

<h3>Authors and Contributors</h3>

<p>Chris Cacciatore (<a href="https://github.com/cacciatc" class="user-mention">@cacciatc</a>)</p>

<h3>Support or Contact</h3>

<ul>
<li>email: <a href="mailto:chris.cacciatore@dullahansoft.com"></a><a href="mailto:chris.cacciatore@dullahansoft.com">chris.cacciatore@dullahansoft.com</a>
</li>
<li>web: <a href="http://www.dullahansoft.com">dullahansoft</a>
</li>
</ul>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-24158768-9");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>